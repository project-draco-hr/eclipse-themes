{
  CTabItem item=parent.getItem(itemIndex);
  int x=bounds.x;
  int y=bounds.y;
  int height=bounds.height;
  int width=bounds.width;
  if (!parent.getSimple() && !parent.getSingle())   width-=(getCurveWidth() - getCurveIndent());
  int rightEdge=Math.min(x + width,getRightItemEdge(parent,gc));
  Rectangle trim=computeTrim(itemIndex,SWT.NONE,0,0,0,0);
  int xDraw=x - trim.x;
  if (parent.getSingle() && (hasStyle(parent,SWT.CLOSE) || hasStyle(item,SWT.CLOSE)))   xDraw+=getCloseRect(item).width;
  Image image=item.getImage();
  if (image != null && !image.isDisposed()) {
    Rectangle imageBounds=image.getBounds();
    int maxImageWidth=rightEdge - xDraw - (trim.width + trim.x);
    if (!parent.getSingle() && getCloseRect(item).width > 0)     maxImageWidth-=getCloseRect(item).width + INTERNAL_SPACING;
    if (imageBounds.width < maxImageWidth) {
      int imageX=xDraw;
      int imageY=y + (height - imageBounds.height) / 2;
      imageY+=parent.getTabPosition() == SWT.BOTTOM ? -1 : 1;
      gc.drawImage(image,imageX,imageY);
      xDraw+=imageBounds.width + INTERNAL_SPACING;
    }
  }
  int textWidth=rightEdge - xDraw - (trim.width + trim.x);
  if (!parent.getSingle() && getCloseRect(item).width > 0)   textWidth-=getCloseRect(item).width + INTERNAL_SPACING;
  if (textWidth > 0) {
    Font gcFont=gc.getFont();
    gc.setFont(item.getFont() == null ? parent.getFont() : item.getFont());
    if (getShortenText(item) == null || getShortenTextWidth(item) != textWidth) {
      setShortenText(item,_shortenText(gc,item.getText(),textWidth));
      setShortenTextWidth(item,textWidth);
    }
    Point extent=gc.textExtent(getShortenText(item),SWT.DRAW_TRANSPARENT | SWT.DRAW_MNEMONIC);
    int textY=y + (height - extent.y) / 2;
    textY+=parent.getTabPosition() == SWT.BOTTOM ? -1 : 1;
    if (selectedTabItemColor != null) {
      gc.setForeground(selectedTabItemColor);
    }
 else {
      gc.setForeground(parent.getSelectionForeground());
    }
    gc.drawText(getShortenText(item),xDraw,textY,SWT.DRAW_TRANSPARENT | SWT.DRAW_MNEMONIC);
    gc.setFont(gcFont);
    if (parent.isFocusControl()) {
      Display display=parent.getDisplay();
      if (parent.getSimple() || parent.getSingle()) {
        gc.setBackground(display.getSystemColor(SWT.COLOR_BLACK));
        gc.setForeground(display.getSystemColor(SWT.COLOR_WHITE));
        gc.drawFocus(xDraw - 1,textY - 1,extent.x + 2,extent.y + 2);
      }
 else {
        gc.setForeground(display.getSystemColor(SWT.COLOR_WIDGET_DARK_SHADOW));
        gc.drawLine(xDraw,textY + extent.y + 1,xDraw + extent.x + 1,textY + extent.y + 1);
      }
    }
  }
  if (hasStyle(parent,SWT.CLOSE) || hasStyle(item,SWT.CLOSE))   _drawClose(gc,getCloseRect(item),getCloseImageState(item));
}
