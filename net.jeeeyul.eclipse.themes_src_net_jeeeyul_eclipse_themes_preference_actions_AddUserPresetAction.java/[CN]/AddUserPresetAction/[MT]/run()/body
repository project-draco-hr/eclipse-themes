{
  InputDialog dialog=new InputDialog(Display.getDefault().getActiveShell(),"New Preset","Enter a new preset name:",null,JTPUtil.getPresetNameValidator());
  if (dialog.open() != IDialogConstants.OK_ID) {
    return;
  }
  UserPreset userPreset=new UserPreset(dialog.getValue().trim());
  Properties presetProps=userPreset.getProperties();
  JThemePreferenceStore store=new JThemePreferenceStore(new PreferenceStore());
  getPage().saveTo(store);
  List<String> presetKeys=JTPUtil.listPreferenceKeys(JTPUtil.FILTER_PRESET);
  for (  String key : presetKeys) {
    presetProps.setProperty(key,store.getString(key));
  }
  try {
    userPreset.save();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  getPage().getPresetManager().invalidateUserPreset();
}
